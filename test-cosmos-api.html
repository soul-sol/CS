<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS_COSMOS PUBG API Test</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
            line-height: 1.8;
        }
        h2 { color: #00ffff; }
        .section {
            background: #2a2a2a;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            border: 1px solid #00ff00;
        }
        .highlight { color: #ffd700; font-weight: bold; }
        .error { color: #ff0000; }
        .success { color: #00ff00; }
        button {
            background: #00ff00;
            color: #000;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        button:hover { background: #00dd00; }
        pre { 
            background: #000; 
            padding: 10px; 
            overflow-x: auto;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>ğŸ® CS_COSMOS PUBG API ì§ì ‘ í…ŒìŠ¤íŠ¸</h1>
    
    <button onclick="testAPI()">API í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
    
    <div class="section">
        <h2>1. í”Œë ˆì´ì–´ ì¡°íšŒ</h2>
        <div id="playerInfo">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div class="section">
        <h2>2. Lifetime í†µê³„ (ì „ì²´ ëª¨ë“œ)</h2>
        <div id="allStats">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div class="section">
        <h2>3. Squad ëª¨ë“œ ë¶„ì„</h2>
        <div id="squadStats">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div class="section">
        <h2>4. ê³„ì‚° ê²°ê³¼</h2>
        <div id="calculations">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div class="section">
        <h2>5. Raw API Response</h2>
        <pre id="rawData" style="max-height: 400px; overflow-y: auto;">ëŒ€ê¸° ì¤‘...</pre>
    </div>

    <script>
        const API_KEY = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI4MjU3MDQyMC02OTQ4LTAxM2UtNDg5ZC00MjVkMGRiNDBlMGYiLCJpc3MiOiJnYW1lbG9ja2VyIiwiaWF0IjoxNzU2NzIwODcwLCJwdWIiOiJibHVlaG9sZSIsInRpdGxlIjoicHViZyIsImFwcCI6Ii00OTcwY2YwOS0zY2RkLTRlYTUtYjVjMy01MGVmY2VlNzExOTYifQ.JNUWXi2YT78qtXFkTHHiQtCaMIXqKTQRSWwRtimeI94';
        const API_BASE_URL = 'https://api.pubg.com/shards/kakao';
        
        async function testAPI() {
            const playerName = 'CS_COSMOS';
            
            try {
                // 1. í”Œë ˆì´ì–´ ID ì¡°íšŒ
                document.getElementById('playerInfo').innerHTML = 'ğŸ” í”Œë ˆì´ì–´ ê²€ìƒ‰ ì¤‘...';
                
                const playerResponse = await fetch(
                    `${API_BASE_URL}/players?filter[playerNames]=${encodeURIComponent(playerName)}`,
                    {
                        headers: {
                            'Authorization': `Bearer ${API_KEY}`,
                            'Accept': 'application/vnd.api+json'
                        }
                    }
                );
                
                const playerData = await playerResponse.json();
                
                if (!playerData.data || playerData.data.length === 0) {
                    document.getElementById('playerInfo').innerHTML = '<span class="error">í”Œë ˆì´ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</span>';
                    return;
                }
                
                const playerId = playerData.data[0].id;
                document.getElementById('playerInfo').innerHTML = 
                    `<span class="success">âœ… í”Œë ˆì´ì–´ ì°¾ìŒ</span><br>` +
                    `Player Name: <span class="highlight">${playerName}</span><br>` +
                    `Player ID: ${playerId}`;
                
                // 2. Lifetime í†µê³„ ì¡°íšŒ
                document.getElementById('allStats').innerHTML = 'ğŸ“Š í†µê³„ ì¡°íšŒ ì¤‘...';
                
                const statsResponse = await fetch(
                    `${API_BASE_URL}/players/${playerId}/seasons/lifetime`,
                    {
                        headers: {
                            'Authorization': `Bearer ${API_KEY}`,
                            'Accept': 'application/vnd.api+json'
                        }
                    }
                );
                
                const statsData = await statsResponse.json();
                const stats = statsData.data.attributes.gameModeStats;
                
                // Raw ë°ì´í„° í‘œì‹œ
                document.getElementById('rawData').textContent = JSON.stringify(stats, null, 2);
                
                // ëª¨ë“  ëª¨ë“œ í†µê³„ í‘œì‹œ
                let allStatsHtml = '<h3>ëª¨ë“  ê²Œì„ ëª¨ë“œ í†µê³„:</h3>';
                let totalKills = 0, totalDeaths = 0, totalAssists = 0, totalGames = 0, totalDamage = 0;
                
                for (const [mode, data] of Object.entries(stats)) {
                    if (data && data.roundsPlayed > 0) {
                        allStatsHtml += `<div style="margin: 10px 0;">`;
                        allStatsHtml += `<strong>${mode}:</strong><br>`;
                        allStatsHtml += `&nbsp;&nbsp;Games: ${data.roundsPlayed}, `;
                        allStatsHtml += `Kills: ${data.kills}, `;
                        allStatsHtml += `Deaths: ${data.deaths}, `;
                        allStatsHtml += `Assists: ${data.assists}<br>`;
                        allStatsHtml += `</div>`;
                        
                        // ì „ì²´ í•©ì‚°
                        totalKills += data.kills || 0;
                        totalDeaths += data.deaths || 0;
                        totalAssists += data.assists || 0;
                        totalGames += data.roundsPlayed || 0;
                        totalDamage += data.damageDealt || 0;
                    }
                }
                
                allStatsHtml += `<div style="margin-top: 20px; border-top: 1px solid #00ff00; padding-top: 10px;">`;
                allStatsHtml += `<strong class="highlight">ëª¨ë“  ëª¨ë“œ í•©ê³„:</strong><br>`;
                allStatsHtml += `ì´ ê²Œì„: ${totalGames}<br>`;
                allStatsHtml += `ì´ í‚¬: <span class="highlight">${totalKills}</span><br>`;
                allStatsHtml += `ì´ ë°ìŠ¤: <span class="highlight">${totalDeaths}</span><br>`;
                allStatsHtml += `ì´ ì–´ì‹œ: <span class="highlight">${totalAssists}</span><br>`;
                allStatsHtml += `</div>`;
                
                document.getElementById('allStats').innerHTML = allStatsHtml;
                
                // 3. Squad ëª¨ë“œë§Œ ë¶„ì„
                const squadTpp = stats['squad'] || {};
                const squadFpp = stats['squad-fpp'] || {};
                
                let squadHtml = '<h3>Squad ëª¨ë“œ ë¶„ì„:</h3>';
                squadHtml += `<div>Squad TPP: ${squadTpp.roundsPlayed || 0} games, ${squadTpp.kills || 0} kills, ${squadTpp.deaths || 0} deaths, ${squadTpp.assists || 0} assists</div>`;
                squadHtml += `<div>Squad FPP: ${squadFpp.roundsPlayed || 0} games, ${squadFpp.kills || 0} kills, ${squadFpp.deaths || 0} deaths, ${squadFpp.assists || 0} assists</div>`;
                
                const squadTotalKills = (squadTpp.kills || 0) + (squadFpp.kills || 0);
                const squadTotalDeaths = (squadTpp.deaths || 0) + (squadFpp.deaths || 0);
                const squadTotalAssists = (squadTpp.assists || 0) + (squadFpp.assists || 0);
                const squadTotalGames = (squadTpp.roundsPlayed || 0) + (squadFpp.roundsPlayed || 0);
                const squadTotalDamage = (squadTpp.damageDealt || 0) + (squadFpp.damageDealt || 0);
                
                squadHtml += `<div style="margin-top: 15px; border-top: 1px solid #00ff00; padding-top: 10px;">`;
                squadHtml += `<strong class="highlight">Squad í•©ê³„:</strong><br>`;
                squadHtml += `ê²Œì„: ${squadTotalGames}<br>`;
                squadHtml += `í‚¬: <span class="highlight">${squadTotalKills}</span><br>`;
                squadHtml += `ë°ìŠ¤: <span class="highlight">${squadTotalDeaths}</span><br>`;
                squadHtml += `ì–´ì‹œ: <span class="highlight">${squadTotalAssists}</span><br>`;
                squadHtml += `ì´ ë°ë¯¸ì§€: ${squadTotalDamage}<br>`;
                squadHtml += `</div>`;
                
                document.getElementById('squadStats').innerHTML = squadHtml;
                
                // 4. KDA ê³„ì‚°
                let calcHtml = '<h3>ê³„ì‚° ê²°ê³¼:</h3>';
                
                // ì „ì²´ ëª¨ë“œ ê¸°ì¤€
                const allKD = totalDeaths > 0 ? (totalKills / totalDeaths).toFixed(2) : '0.00';
                const allKDA = totalDeaths > 0 ? ((totalKills + totalAssists) / totalDeaths).toFixed(2) : '0.00';
                const allKDAPerGame = totalGames > 0 ? ((totalKills + totalAssists) / totalGames).toFixed(2) : '0.00';
                
                calcHtml += `<div style="margin-bottom: 15px;">`;
                calcHtml += `<strong>ì „ì²´ ëª¨ë“œ ê¸°ì¤€:</strong><br>`;
                calcHtml += `K/D = ${totalKills} / ${totalDeaths} = <span class="highlight">${allKD}</span><br>`;
                calcHtml += `KDA (traditional) = (${totalKills} + ${totalAssists}) / ${totalDeaths} = <span class="highlight">${allKDA}</span><br>`;
                calcHtml += `KDA (per game) = (${totalKills} + ${totalAssists}) / ${totalGames} = <span class="highlight">${allKDAPerGame}</span><br>`;
                calcHtml += `</div>`;
                
                // Squad ëª¨ë“œ ê¸°ì¤€
                const squadKD = squadTotalDeaths > 0 ? (squadTotalKills / squadTotalDeaths).toFixed(2) : '0.00';
                const squadKDA = squadTotalDeaths > 0 ? ((squadTotalKills + squadTotalAssists) / squadTotalDeaths).toFixed(2) : '0.00';
                const squadKDAPerGame = squadTotalGames > 0 ? ((squadTotalKills + squadTotalAssists) / squadTotalGames).toFixed(2) : '0.00';
                const squadAvgDamage = squadTotalGames > 0 ? Math.round(squadTotalDamage / squadTotalGames) : 0;
                
                calcHtml += `<div>`;
                calcHtml += `<strong>Squad ëª¨ë“œë§Œ:</strong><br>`;
                calcHtml += `K/D = ${squadTotalKills} / ${squadTotalDeaths} = <span class="highlight">${squadKD}</span><br>`;
                calcHtml += `KDA (traditional) = (${squadTotalKills} + ${squadTotalAssists}) / ${squadTotalDeaths} = <span class="highlight">${squadKDA}</span><br>`;
                calcHtml += `KDA (per game) = (${squadTotalKills} + ${squadTotalAssists}) / ${squadTotalGames} = <span class="highlight">${squadKDAPerGame}</span><br>`;
                calcHtml += `í‰ê·  ë°ë¯¸ì§€ = ${squadTotalDamage} / ${squadTotalGames} = <span class="highlight">${squadAvgDamage}</span><br>`;
                calcHtml += `</div>`;
                
                calcHtml += `<div style="margin-top: 20px; padding: 10px; background: #333; border-radius: 5px;">`;
                calcHtml += `<strong>ğŸ¯ ì˜ˆìƒê°’ vs ì‹¤ì œê°’:</strong><br>`;
                calcHtml += `ì˜ˆìƒ: 685í‚¬, 312ì–´ì‹œ, 591ë°ìŠ¤<br>`;
                calcHtml += `ì‹¤ì œ (Squad): ${squadTotalKills}í‚¬, ${squadTotalAssists}ì–´ì‹œ, ${squadTotalDeaths}ë°ìŠ¤<br>`;
                calcHtml += `ì‹¤ì œ (ì „ì²´): ${totalKills}í‚¬, ${totalAssists}ì–´ì‹œ, ${totalDeaths}ë°ìŠ¤<br>`;
                calcHtml += `</div>`;
                
                document.getElementById('calculations').innerHTML = calcHtml;
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('playerInfo').innerHTML = 
                    `<span class="error">ì—ëŸ¬ ë°œìƒ: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>
